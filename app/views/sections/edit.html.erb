<div class="max-w-4xl mx-auto">
  <div class="flex justify-between items-center mb-8">
    <h1 class="font-bold text-3xl text-[#2C2C2C]">Edit Section: <%= @section.name %></h1>
    <%= link_to "Back to Register", edit_cash_register_path(@section.cash_register), class: "text-gray-600 hover:text-[#FFD100]" %>
  </div>

  <div class="bg-white shadow rounded-lg p-6 mb-8">
    <%= form_with(model: @section, class: "space-y-4") do |form| %>
      <div>
        <%= form.label :name, class: "block font-medium text-gray-700" %>
        <%= form.text_field :name, class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-[#FFD100] focus:ring-[#FFD100]" %>
      </div>

      <div>
        <%= form.submit "Update Section Details", class: "bg-[#2C2C2C] text-white px-4 py-2 rounded font-medium hover:bg-black cursor-pointer" %>
      </div>
    <% end %>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
    <div>
      <h2 class="text-xl font-bold mb-4">Add Articles</h2>
      <div class="bg-white shadow rounded-lg p-6">
        <%= form_with url: add_article_section_path(@section), method: :post, class: "flex gap-2" do |form| %>
          <%= form.text_field :query, class: "block w-full rounded-md border-gray-300 shadow-sm focus:border-[#FFD100] focus:ring-[#FFD100] p-2 border", placeholder: "Scan Barcode or Enter SKU", autofocus: true %>
          <%= form.submit "Add", class: "bg-[#FFD100] text-[#2C2C2C] px-4 py-2 rounded font-bold hover:bg-yellow-400 cursor-pointer" %>
        <% end %>
        <p class="text-sm text-gray-500 mt-2">Scan an item to add it to this section manualy.</p>
        
        <% if defined?(@search_results) && @search_results.present? %>
        <div class="mt-4 border-t border-gray-100 pt-4">
           <h3 class="font-bold text-sm mb-2 text-gray-700">Select Article:</h3>
           <ul class="divide-y divide-gray-100 max-h-80 overflow-y-auto">
             <% @search_results.each do |result| %>
               <li class="py-2 flex justify-between items-center group">
                 <div>
                    <div class="font-medium text-sm text-gray-900"><%= result.name %></div>
                    <div class="text-xs text-gray-500 font-mono"><%= result.sku %></div>
                 </div>
                 <%= button_to "HinzufÃ¼gen", add_article_section_path(@section, article_id: result.id, search_query: params[:search_query]), method: :post, class: "bg-gray-100 text-gray-700 px-3 py-1 rounded text-xs font-bold hover:bg-[#FFD100] hover:text-black transition" %>
               </li>
             <% end %>
           </ul>
        </div>
        <% end %>
      </div>
    </div>

    <div>
      <h2 class="text-xl font-bold mb-4">Current Articles</h2>
      <div class="bg-white shadow rounded-lg overflow-hidden">
        <% if @articles.any? %>
          <ul class="divide-y divide-gray-200" data-controller="sortable" data-sortable-url-value="<%= reorder_section_path(@section) %>">
            <% @articles.each do |article| %>
              <li class="p-4 flex justify-between items-center hover:bg-gray-50 cursor-move" data-id="<%= article.id %>">
                <div class="flex items-center">
                    <svg class="w-4 h-4 text-gray-400 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
                    <div>
                      <p class="font-medium text-gray-900"><%= article.name %></p>
                      <p class="text-sm text-gray-500"><%= article.sku %></p>
                    </div>
                </div>
                <%= button_to "Remove", remove_article_section_path(@section, article_id: article.id), method: :delete, class: "text-red-600 hover:text-red-900 text-sm font-medium" %>
              </li>
            <% end %>
          </ul>
        <% else %>
          <div class="p-6 text-center text-gray-500">
            No manual articles added.
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
